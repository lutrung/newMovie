{"ast":null,"code":"import _defineProperty from\"D:/FrontEnd/Project/newMovie/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"D:/FrontEnd/Project/newMovie/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"D:/FrontEnd/Project/newMovie/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/* eslint-disable array-callback-return */ /* eslint-disable react-hooks/rules-of-hooks */import React,{useEffect,useRef,useState}from'react';import imgEmpty from'../../../Assets/Images/unnamed.png';import moment from'moment';import Box from'@mui/material/Box';import TextField from'@mui/material/TextField';import Button from'@mui/material/Button';import Dialog from'@mui/material/Dialog';import DialogActions from'@mui/material/DialogActions';import DialogContent from'@mui/material/DialogContent';import DialogTitle from'@mui/material/DialogTitle';import AdapterDateFns from'@mui/lab/AdapterDateFns';import LocalizationProvider from'@mui/lab/LocalizationProvider';import DatePicker from'@mui/lab/DatePicker';import{useDispatch}from'react-redux';import{addMovie}from'../../../Redux/Actions/MovieManagerActions';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function AddMovie(_ref){var open=_ref.open,handleClose=_ref.handleClose;var dispatch=useDispatch();var _useState=useState({tenPhim:{error:false,message:'Tên phim không được bỏ trống'},trailer:{error:false,message:'Trailer không được bỏ trống'},ngayKhoiChieu:{error:false,message:'Ngày khởi chiếu được bỏ trống'},danhGia:{error:false,message:'Đánh giá không được bỏ trống'},moTa:{error:false,message:'Mô tả không được bỏ trống'},hinhAnh:{error:false,message:'Hình ảnh không được bỏ trống'},biDanh:{error:false,message:'Bí danh không được bỏ trống'}}),_useState2=_slicedToArray(_useState,2),errors=_useState2[0],setErrors=_useState2[1];var _useState3=useState({tenPhim:'',trailer:'',ngayKhoiChieu:new Date(),danhGia:'',moTa:'',hinhAnh:{},biDanh:'',maNhom:'GP01'}),_useState4=_slicedToArray(_useState3,2),dataMovie=_useState4[0],setDataMovie=_useState4[1];var inputAdd=useRef(null);var onAdd=function onAdd(){inputAdd.current.click();};var _useState5=useState(imgEmpty),_useState6=_slicedToArray(_useState5,2),imgSrc=_useState6[0],setImgSrc=_useState6[1];var onSelectDate=function onSelectDate(newDate){console.log(newDate);var newDataMovie=_objectSpread(_objectSpread({},dataMovie),{},{ngayKhoiChieu:newDate});setDataMovie(newDataMovie);};var onChangeInput=function onChangeInput(event){var _event$target=event.target,name=_event$target.name,value=_event$target.value;if(name==='hinhAnh'){var newImgSrc=event.target.files[0];if(newImgSrc.type==='image/png'||newImgSrc.type==='image/jpg'||newImgSrc.type==='image/gif'||newImgSrc.type==='image/jpeg'){var newDataMovie=_objectSpread(_objectSpread({},dataMovie),{},_defineProperty({},name,newImgSrc));setDataMovie(newDataMovie);setImgSrc(URL.createObjectURL(newImgSrc));}}else if(name==='danhGia'){var _newDataMovie=_objectSpread(_objectSpread({},dataMovie),{},_defineProperty({},name,value));setDataMovie(_newDataMovie);if(value<0||value>10){var _newDataMovie2=_objectSpread(_objectSpread({},dataMovie),{},_defineProperty({},name,0));setDataMovie(_newDataMovie2);var newErrors=_objectSpread({},errors);newErrors[name].error=true;newErrors[name].message='Đánh giá từ 0 - 10';setErrors(newErrors);}else if(!value){var _newErrors=_objectSpread({},errors);_newErrors[name].error=true;setErrors(_newErrors);}else{var _newErrors2=_objectSpread({},errors);_newErrors2[name].error=false;_newErrors2[name].message='Đánh giá không được bỏ trống';setErrors(_newErrors2);}}else{var _newDataMovie3=_objectSpread(_objectSpread({},dataMovie),{},_defineProperty({},name,value));setDataMovie(_newDataMovie3);if(!value){var _newErrors3=_objectSpread({},errors);_newErrors3[name].error=true;setErrors(_newErrors3);}else{var _newErrors4=_objectSpread({},errors);_newErrors4[name].error=false;setErrors(_newErrors4);}}};var resetForm=function resetForm(){setDataMovie({tenPhim:'',trailer:'',ngayKhoiChieu:new Date(),danhGia:'',moTa:'',hinhAnh:{},biDanh:'',maNhom:'GP01'});setErrors({tenPhim:{error:false,message:'Tên phim không được bỏ trống'},trailer:{error:false,message:'Trailer không được bỏ trống'},ngayKhoiChieu:{error:false,message:'Ngày khởi chiếu được bỏ trống'},danhGia:{error:false,message:'Đánh giá không được bỏ trống'},moTa:{error:false,message:'Mô tả không được bỏ trống'},hinhAnh:{error:false,message:'Hình ảnh không được bỏ trống'},biDanh:{error:false,message:'Bí danh không được bỏ trống'}});setImgSrc(imgEmpty);};var checkEmpty=function checkEmpty(text){return!/[^\\s]/.test(text);};var checkValidation=function checkValidation(data){var _Object$keys,_Object$values;var outPut=_objectSpread({},errors);(_Object$keys=Object.keys(errors))===null||_Object$keys===void 0?void 0:_Object$keys.forEach(function(item){if(checkEmpty(data[item])){outPut[item].error=true;}else if(data[item]===null){outPut[item].error=true;}else{outPut[item].error=false;}});setErrors(outPut);var isError=(_Object$values=Object.values(outPut))===null||_Object$values===void 0?void 0:_Object$values.some(function(item){return item.error;});return isError;};var trimValues=function trimValues(data){return Object.keys(data).map(function(key){if(key!=='hinhAnh'&&key!=='danhGia'){return data[key]=String(data[key]).trim();}else if(key==='danhGia'){return data[key]=Number(data[key]);}});};var onSubmit=function onSubmit(){var checkError=checkValidation(dataMovie);if(checkError){return;}else{dataMovie.ngayKhoiChieu=moment(dataMovie.ngayKhoiChieu).format('DD/MM/YYYY');trimValues(dataMovie);var form_data=new FormData();for(var key in dataMovie){form_data.append(key,dataMovie[key]);}dispatch(addMovie(form_data));resetForm();handleClose();}};useEffect(function(){if(!open){resetForm();}},[open]);return/*#__PURE__*/_jsxs(Dialog,{fullWidth:true,maxWidth:\"md\",open:open,keepMounted:true,onClose:handleClose,\"aria-describedby\":\"alert-dialog-slide-description\",children:[/*#__PURE__*/_jsx(DialogTitle,{sx:{fontSize:'30px'},children:\"Thêm phim\"}),/*#__PURE__*/_jsx(DialogContent,{dividers:true,children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',alignItems:'start','& .MuiTextField-root':{mb:2,width:'100%'},'& .MuiOutlinedInput-root, .MuiInputLabel-root':{fontSize:'15px'},'& .form-left':{width:'60%'},'& .form-right':{width:'37%'},'& .MuiButton-root':{display:'block',mb:2,fontSize:'15px',backgroundColor:'#d7d7d7',color:'#616161',width:'100%'}},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-left\",children:[/*#__PURE__*/_jsx(TextField,{required:true,name:\"tenPhim\",label:\"T\\xEAn Phim\",variant:\"outlined\",onChange:onChangeInput,value:dataMovie.tenPhim,error:errors.tenPhim.error,helperText:errors.tenPhim.error?errors.tenPhim.message:''}),/*#__PURE__*/_jsx(TextField,{required:true,name:\"trailer\",label:\"Trailer\",variant:\"outlined\",onChange:onChangeInput,value:dataMovie.trailer,error:errors.trailer.error,helperText:errors.trailer.error?errors.trailer.message:''}),/*#__PURE__*/_jsx(TextField,{required:true,name:\"biDanh\",label:\"B\\xED Danh\",variant:\"outlined\",onChange:onChangeInput,value:dataMovie.biDanh,error:errors.biDanh.error,helperText:errors.biDanh.error?errors.biDanh.message:''}),/*#__PURE__*/_jsx(TextField,{required:true,name:\"danhGia\",label:\"\\u0110\\xE1nh gi\\xE1\",variant:\"outlined\",type:\"number\",onChange:onChangeInput,value:dataMovie.danhGia,error:errors.danhGia.error,helperText:errors.danhGia.error?errors.danhGia.message:'',InputProps:{inputProps:{max:10,min:0}}}),/*#__PURE__*/_jsx(TextField,{name:\"maNhom\",label:\"M\\xE3 nh\\xF3m\",value:\"GP01\",disabled:true,variant:\"outlined\",onChange:onChangeInput}),/*#__PURE__*/_jsx(TextField,{required:true,name:\"moTa\",label:\"M\\xF4 t\\u1EA3\",multiline:true,rows:3,variant:\"outlined\",onChange:onChangeInput,value:dataMovie.moTa,error:errors.moTa.error,helperText:errors.moTa.error?errors.moTa.message:''})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-right\",children:[/*#__PURE__*/_jsx(LocalizationProvider,{dateAdapter:AdapterDateFns,children:/*#__PURE__*/_jsx(DatePicker,{label:\"Ng\\xE0y kh\\u1EDFi chi\\u1EBFu\",value:new Date(dataMovie.ngayKhoiChieu),name:\"ngayKhoiChieu\",onChange:function onChange(newDate){return onSelectDate(newDate);},disablePast:true,renderInput:function renderInput(params){return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},params),{},{required:true,error:errors.ngayKhoiChieu.error,helperText:errors.ngayKhoiChieu.error?errors.ngayKhoiChieu.message:''}));}})}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:function onClick(){return onAdd();},children:\"T\\u1EA3i \\u1EA3nh l\\xEAn\"}),/*#__PURE__*/_jsx(\"input\",{name:\"hinhAnh\",type:\"file\",hidden:true,ref:inputAdd,onChange:onChangeInput}),/*#__PURE__*/_jsx(\"img\",{style:{width:'100%'},src:imgSrc,alt:\"...\"})]})]})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"error\",onClick:handleClose,children:\"H\\u1EE7y\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:onSubmit,type:\"submit\",children:\"Th\\xEAm\"})]})]});};","map":{"version":3,"sources":["D:/FrontEnd/Project/newMovie/src/Pages/Admin/Movie/AddMovie.js"],"names":["React","useEffect","useRef","useState","imgEmpty","moment","Box","TextField","Button","Dialog","DialogActions","DialogContent","DialogTitle","AdapterDateFns","LocalizationProvider","DatePicker","useDispatch","addMovie","AddMovie","open","handleClose","dispatch","tenPhim","error","message","trailer","ngayKhoiChieu","danhGia","moTa","hinhAnh","biDanh","errors","setErrors","Date","maNhom","dataMovie","setDataMovie","inputAdd","onAdd","current","click","imgSrc","setImgSrc","onSelectDate","newDate","console","log","newDataMovie","onChangeInput","event","target","name","value","newImgSrc","files","type","URL","createObjectURL","newErrors","resetForm","checkEmpty","text","test","checkValidation","data","outPut","Object","keys","forEach","item","isError","values","some","trimValues","map","key","String","trim","Number","onSubmit","checkError","format","form_data","FormData","append","fontSize","display","justifyContent","alignItems","mb","width","backgroundColor","color","inputProps","max","min","params"],"mappings":"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","sourcesContent":["/* eslint-disable array-callback-return */\r\n/* eslint-disable react-hooks/rules-of-hooks */\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport imgEmpty from '../../../Assets/Images/unnamed.png'\r\nimport moment from 'moment';\r\nimport Box from '@mui/material/Box';\r\nimport TextField from '@mui/material/TextField';\r\nimport Button from '@mui/material/Button';\r\nimport Dialog from '@mui/material/Dialog';\r\nimport DialogActions from '@mui/material/DialogActions';\r\nimport DialogContent from '@mui/material/DialogContent';\r\nimport DialogTitle from '@mui/material/DialogTitle';\r\n\r\n\r\n\r\nimport AdapterDateFns from '@mui/lab/AdapterDateFns';\r\nimport LocalizationProvider from '@mui/lab/LocalizationProvider';\r\nimport DatePicker from '@mui/lab/DatePicker';\r\nimport { useDispatch } from 'react-redux';\r\nimport { addMovie } from '../../../Redux/Actions/MovieManagerActions';\r\n\r\n\r\nexport default function AddMovie({ open, handleClose }) {\r\n    const dispatch = useDispatch()\r\n    const [errors, setErrors] = useState({\r\n        tenPhim: {\r\n            error: false,\r\n            message: 'Tên phim không được bỏ trống',\r\n        },\r\n        trailer: {\r\n            error: false,\r\n            message: 'Trailer không được bỏ trống',\r\n        },\r\n        ngayKhoiChieu: {\r\n            error: false,\r\n            message: 'Ngày khởi chiếu được bỏ trống',\r\n        },\r\n        danhGia: {\r\n            error: false,\r\n            message: 'Đánh giá không được bỏ trống',\r\n        },\r\n        moTa: {\r\n            error: false,\r\n            message: 'Mô tả không được bỏ trống',\r\n        },\r\n        hinhAnh: {\r\n            error: false,\r\n            message: 'Hình ảnh không được bỏ trống',\r\n        },\r\n        biDanh: {\r\n            error: false,\r\n            message: 'Bí danh không được bỏ trống',\r\n        },\r\n    })\r\n    const [dataMovie, setDataMovie] = useState({\r\n        tenPhim: '',\r\n        trailer: '',\r\n        ngayKhoiChieu: new Date(),\r\n        danhGia: '',\r\n        moTa: '',\r\n        hinhAnh: {},\r\n        biDanh: '',\r\n        maNhom: 'GP01',\r\n    })\r\n    const inputAdd = useRef(null);\r\n    const onAdd = () => {\r\n        inputAdd.current.click();\r\n    };\r\n    const [imgSrc, setImgSrc] = useState(imgEmpty);\r\n    const onSelectDate = (newDate) => {\r\n        console.log(newDate);\r\n        let newDataMovie = { ...dataMovie, ngayKhoiChieu: newDate }\r\n        setDataMovie(newDataMovie)\r\n    }\r\n    const onChangeInput = (event) => {\r\n        let { name, value } = event.target\r\n        if (name === 'hinhAnh') {\r\n            let newImgSrc = event.target.files[0]\r\n            if (newImgSrc.type === 'image/png' || newImgSrc.type === 'image/jpg' || newImgSrc.type === 'image/gif' || newImgSrc.type === 'image/jpeg') {\r\n                let newDataMovie = { ...dataMovie, [name]: newImgSrc }\r\n                setDataMovie(newDataMovie)\r\n                setImgSrc(URL.createObjectURL(newImgSrc))\r\n            }\r\n        } else if (name === 'danhGia') {\r\n            let newDataMovie = { ...dataMovie, [name]: value }\r\n            setDataMovie(newDataMovie)\r\n            if (value < 0 || value > 10) {\r\n                let newDataMovie = { ...dataMovie, [name]: 0 }\r\n                setDataMovie(newDataMovie)\r\n                let newErrors = { ...errors }\r\n                newErrors[name].error = true\r\n                newErrors[name].message = 'Đánh giá từ 0 - 10'\r\n                setErrors(newErrors)\r\n            } else if (!value) {\r\n                let newErrors = { ...errors }\r\n                newErrors[name].error = true\r\n                setErrors(newErrors)\r\n            } else {\r\n                let newErrors = { ...errors }\r\n                newErrors[name].error = false\r\n                newErrors[name].message = 'Đánh giá không được bỏ trống'\r\n                setErrors(newErrors)\r\n            }\r\n        } else {\r\n            let newDataMovie = { ...dataMovie, [name]: value }\r\n            setDataMovie(newDataMovie)\r\n            if (!value) {\r\n                let newErrors = { ...errors }\r\n                newErrors[name].error = true\r\n                setErrors(newErrors)\r\n            } else {\r\n                let newErrors = { ...errors }\r\n                newErrors[name].error = false\r\n                setErrors(newErrors)\r\n            }\r\n        }\r\n    }\r\n    const resetForm = () => {\r\n        setDataMovie({\r\n            tenPhim: '',\r\n            trailer: '',\r\n            ngayKhoiChieu: new Date(),\r\n            danhGia: '',\r\n            moTa: '',\r\n            hinhAnh: {},\r\n            biDanh: '',\r\n            maNhom: 'GP01',\r\n        })\r\n        setErrors({\r\n            tenPhim: {\r\n                error: false,\r\n                message: 'Tên phim không được bỏ trống',\r\n            },\r\n            trailer: {\r\n                error: false,\r\n                message: 'Trailer không được bỏ trống',\r\n            },\r\n            ngayKhoiChieu: {\r\n                error: false,\r\n                message: 'Ngày khởi chiếu được bỏ trống',\r\n            },\r\n            danhGia: {\r\n                error: false,\r\n                message: 'Đánh giá không được bỏ trống',\r\n            },\r\n            moTa: {\r\n                error: false,\r\n                message: 'Mô tả không được bỏ trống',\r\n            },\r\n            hinhAnh: {\r\n                error: false,\r\n                message: 'Hình ảnh không được bỏ trống',\r\n            },\r\n            biDanh: {\r\n                error: false,\r\n                message: 'Bí danh không được bỏ trống',\r\n            },\r\n        })\r\n        setImgSrc(imgEmpty)\r\n    }\r\n    const checkEmpty = (text) => {\r\n        return !/[^\\s]/.test(text);\r\n    }\r\n    const checkValidation = (data) => {\r\n        let outPut = { ...errors };\r\n        Object.keys(errors)?.forEach((item) => {\r\n            if (checkEmpty(data[item])) {\r\n                outPut[item].error = true;\r\n            } else if (data[item] === null) {\r\n                outPut[item].error = true;\r\n            } else {\r\n                outPut[item].error = false;\r\n            }\r\n        });\r\n        setErrors(outPut);\r\n        const isError = Object.values(outPut)?.some((item) => item.error);\r\n        return isError;\r\n    };\r\n    const trimValues = (data) => {\r\n        return Object.keys(data).map((key) => {\r\n            if (key !== 'hinhAnh' && key !== 'danhGia') {\r\n                return data[key] = String(data[key]).trim()\r\n            } else if (key === 'danhGia') {\r\n                return data[key] = Number(data[key])\r\n            }\r\n        });\r\n    }\r\n    const onSubmit = () => {\r\n        let checkError = checkValidation(dataMovie)\r\n        if (checkError) {\r\n            return\r\n        } else {\r\n            dataMovie.ngayKhoiChieu = moment(dataMovie.ngayKhoiChieu).format('DD/MM/YYYY')\r\n            trimValues(dataMovie)\r\n            let form_data = new FormData();\r\n            for (let key in dataMovie) {\r\n                form_data.append(key, dataMovie[key]);\r\n            }\r\n            dispatch(addMovie(form_data))\r\n            resetForm()\r\n            handleClose()\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (!open) {\r\n            resetForm()\r\n        }\r\n    }, [open])\r\n    return (\r\n        <Dialog\r\n            fullWidth\r\n            maxWidth='md'\r\n            open={open}\r\n            keepMounted\r\n            onClose={handleClose}\r\n            aria-describedby=\"alert-dialog-slide-description\"\r\n        >\r\n            <DialogTitle sx={{ fontSize: '30px' }}>{\"Thêm phim\"}</DialogTitle>\r\n            <DialogContent dividers>\r\n                <Box sx={{\r\n                    display: 'flex',\r\n                    justifyContent: 'space-between',\r\n                    alignItems: 'start',\r\n                    '& .MuiTextField-root': { mb: 2, width: '100%' },\r\n                    '& .MuiOutlinedInput-root, .MuiInputLabel-root': { fontSize: '15px' },\r\n                    '& .form-left': { width: '60%' },\r\n                    '& .form-right': { width: '37%' },\r\n                    '& .MuiButton-root': { display: 'block', mb: 2, fontSize: '15px', backgroundColor: '#d7d7d7', color: '#616161', width: '100%' },\r\n                }}>\r\n                    <div className='form-left'>\r\n                        <TextField\r\n                            required\r\n                            name='tenPhim'\r\n                            label=\"Tên Phim\"\r\n                            variant=\"outlined\"\r\n                            onChange={onChangeInput}\r\n                            value={dataMovie.tenPhim}\r\n                            error={errors.tenPhim.error}\r\n                            helperText={errors.tenPhim.error ? errors.tenPhim.message : ''}\r\n                        />\r\n                        <TextField\r\n                            required\r\n                            name='trailer'\r\n                            label=\"Trailer\"\r\n                            variant=\"outlined\"\r\n                            onChange={onChangeInput}\r\n                            value={dataMovie.trailer}\r\n                            error={errors.trailer.error}\r\n                            helperText={errors.trailer.error ? errors.trailer.message : ''}\r\n                        />\r\n                        <TextField\r\n                            required\r\n                            name='biDanh'\r\n                            label=\"Bí Danh\"\r\n                            variant=\"outlined\"\r\n                            onChange={onChangeInput}\r\n                            value={dataMovie.biDanh}\r\n                            error={errors.biDanh.error}\r\n                            helperText={errors.biDanh.error ? errors.biDanh.message : ''}\r\n                        />\r\n                        <TextField\r\n                            required\r\n                            name='danhGia'\r\n                            label=\"Đánh giá\"\r\n                            variant=\"outlined\"\r\n                            type='number'\r\n                            onChange={onChangeInput}\r\n                            value={dataMovie.danhGia}\r\n                            error={errors.danhGia.error}\r\n                            helperText={errors.danhGia.error ? errors.danhGia.message : ''}\r\n                            InputProps={{\r\n                                inputProps: {\r\n                                    max: 10, min: 0\r\n                                }\r\n                            }}\r\n                        />\r\n                        <TextField\r\n                            name='maNhom'\r\n                            label=\"Mã nhóm\"\r\n                            value='GP01'\r\n                            disabled\r\n                            variant=\"outlined\"\r\n                            onChange={onChangeInput}\r\n                        />\r\n                        <TextField\r\n                            required\r\n                            name='moTa'\r\n                            label=\"Mô tả\"\r\n                            multiline\r\n                            rows={3}\r\n                            variant=\"outlined\"\r\n                            onChange={onChangeInput}\r\n                            value={dataMovie.moTa}\r\n                            error={errors.moTa.error}\r\n                            helperText={errors.moTa.error ? errors.moTa.message : ''}\r\n                        />\r\n                    </div>\r\n                    <div className='form-right'>\r\n                        <LocalizationProvider dateAdapter={AdapterDateFns}>\r\n                            <DatePicker\r\n                                label=\"Ngày khởi chiếu\"\r\n                                value={new Date(dataMovie.ngayKhoiChieu)}\r\n                                name='ngayKhoiChieu'\r\n                                onChange={(newDate) => onSelectDate(newDate)}\r\n                                disablePast\r\n                                renderInput={(params) => <TextField {...params}\r\n                                    required\r\n                                    error={errors.ngayKhoiChieu.error}\r\n                                    helperText={errors.ngayKhoiChieu.error ? errors.ngayKhoiChieu.message : ''}\r\n                                />}\r\n                            />\r\n                        </LocalizationProvider>\r\n                        <Button variant='contained' onClick={() => onAdd()} >\r\n                            Tải ảnh lên\r\n                        </Button>\r\n                        <input name='hinhAnh' type='file' hidden ref={inputAdd} onChange={onChangeInput} />\r\n                        <img style={{ width: '100%' }} src={imgSrc} alt='...' />\r\n                    </div>\r\n                </Box>\r\n            </DialogContent>\r\n            <DialogActions>\r\n                <Button variant='contained' color='error' onClick={handleClose} >Hủy</Button>\r\n                <Button variant='contained' color='primary' onClick={onSubmit} type='submit'>Thêm</Button>\r\n            </DialogActions>\r\n        </Dialog>\r\n\r\n    );\r\n};"]},"metadata":{},"sourceType":"module"}