{"ast":null,"code":"import _regeneratorRuntime from\"D:/FrontEnd/Project/newMovie/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/FrontEnd/Project/newMovie/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"D:/FrontEnd/Project/newMovie/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"D:/FrontEnd/Project/newMovie/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"D:/FrontEnd/Project/newMovie/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/* eslint-disable react-hooks/rules-of-hooks */import AdapterDateFns from'@mui/lab/AdapterDateFns';import DatePicker from'@mui/lab/DatePicker';import LocalizationProvider from'@mui/lab/LocalizationProvider';import Box from'@mui/material/Box';import Button from'@mui/material/Button';import Dialog from'@mui/material/Dialog';import DialogActions from'@mui/material/DialogActions';import DialogContent from'@mui/material/DialogContent';import DialogTitle from'@mui/material/DialogTitle';import TextField from'@mui/material/TextField';import{isEmpty}from'lodash';import moment from'moment';import React,{useEffect,useRef,useState}from'react';import{useDispatch,useSelector}from'react-redux';import{getInfoMovie,updateMovie}from'../../../Redux/Actions/MovieManagerActions';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function EditMovie(_ref){var open=_ref.open,handleClose=_ref.handleClose,movieCode=_ref.movieCode;var movieInfo=useSelector(function(state){return state.MovieManagerReducer.movieInfo;});var dispatch=useDispatch();var _useState=useState(),_useState2=_slicedToArray(_useState,2),imgSrc=_useState2[0],setImgSrc=_useState2[1];var _React$useState=React.useState(null),_React$useState2=_slicedToArray(_React$useState,2),date=_React$useState2[0],setDate=_React$useState2[1];var _useState3=useState({tenPhim:'',trailer:'',ngayKhoiChieu:'',danhGia:null,moTa:'',hinhAnh:{},biDanh:'',maNhom:'GP01'}),_useState4=_slicedToArray(_useState3,2),dataMovie=_useState4[0],setDataMovie=_useState4[1];var inputAdd=useRef(null);var onAdd=function onAdd(){inputAdd.current.click();};var onSelectDate=function onSelectDate(newDate){var newDataMovie=_objectSpread(_objectSpread({},dataMovie),{},{ngayKhoiChieu:moment(newDate).format('DD/MM/YYYY')});setDate(newDate);setDataMovie(newDataMovie);};var onChangeInput=function onChangeInput(event){var _event$target=event.target,name=_event$target.name,value=_event$target.value;if(name!=='hinhAnh'){var newDataMovie=_objectSpread(_objectSpread({},dataMovie),{},_defineProperty({},name,value));setDataMovie(newDataMovie);}else{var newImgSrc=event.target.files[0];if(newImgSrc.type==='image/png'||newImgSrc.type==='image/jpg'||newImgSrc.type==='image/gif'||newImgSrc.type==='image/jpeg'){var _newDataMovie=_objectSpread(_objectSpread({},dataMovie),{},_defineProperty({},name,newImgSrc));setDataMovie(_newDataMovie);setImgSrc(URL.createObjectURL(newImgSrc));}}};var onSubmit=function onSubmit(){// ------xoa khoang trang thua\nObject.keys(dataMovie).map(function(key){return dataMovie[key]=String(dataMovie[key]).trim();});// ---------------------------\nvar form_data=new FormData();for(var key in dataMovie){form_data.append(key,dataMovie[key]);}dispatch(updateMovie(form_data));handleClose();};useEffect(function(){if(!isEmpty(movieInfo)){var newDataUpdate={tenPhim:movieInfo.tenPhim,trailer:movieInfo.trailer,ngayKhoiChieu:moment(movieInfo.ngayKhoiChieu).format('DD/MM/YYYY'),danhGia:movieInfo.danhGia,moTa:movieInfo.moTa,hinhAnh:movieInfo.hinhAnh,biDanh:movieInfo.biDanh,maNhom:movieInfo.maNhom};setImgSrc(movieInfo.hinhAnh);setDate(moment(movieInfo.ngayKhoiChieu).format());setDataMovie(newDataUpdate);}},[movieInfo]);useEffect(function(){if(movieCode){var fetchData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.t0=dispatch;_context.next=3;return getInfoMovie(movieCode);case 3:_context.t1=_context.sent;(0,_context.t0)(_context.t1);case 5:case\"end\":return _context.stop();}}},_callee);}));return function fetchData(){return _ref2.apply(this,arguments);};}();fetchData();}},[dispatch,movieCode]);return/*#__PURE__*/_jsxs(Dialog,{fullWidth:true,maxWidth:\"md\",open:open,keepMounted:true,onClose:handleClose,\"aria-describedby\":\"alert-dialog-slide-description\",children:[/*#__PURE__*/_jsx(DialogTitle,{sx:{fontSize:'30px'},children:\"Sửa phim\"}),/*#__PURE__*/_jsx(DialogContent,{dividers:true,children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',alignItems:'start','& .MuiTextField-root':{mb:2,width:'100%'},'& .MuiOutlinedInput-root, .MuiInputLabel-root':{fontSize:'15px'},'& .form-left':{width:'60%'},'& .form-right':{width:'37%'},'& .MuiButton-root':{display:'block',mb:2,fontSize:'15px',backgroundColor:'#d7d7d7',color:'#616161',width:'100%'}},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-left\",children:[/*#__PURE__*/_jsx(TextField,{name:\"tenPhim\",label:\"T\\xEAn Phim\",variant:\"outlined\",onChange:onChangeInput,value:dataMovie.tenPhim,defaultValue:\"Loading...\"}),/*#__PURE__*/_jsx(TextField,{name:\"trailer\",label:\"Trailer\",variant:\"outlined\",onChange:onChangeInput,value:dataMovie.trailer,defaultValue:\"Loading...\"}),/*#__PURE__*/_jsx(TextField,{name:\"biDanh\",label:\"B\\xED Danh\",variant:\"outlined\",onChange:onChangeInput,value:dataMovie.biDanh,defaultValue:\"Loading...\"}),/*#__PURE__*/_jsx(TextField,{name:\"danhGia\",label:\"\\u0110\\xE1nh gi\\xE1\",variant:\"outlined\",type:\"number\",onChange:onChangeInput,value:dataMovie.danhGia,defaultValue:\"0\"}),/*#__PURE__*/_jsx(TextField,{name:\"maNhom\",label:\"M\\xE3 nh\\xF3m\",value:\"GP01\",disabled:true,variant:\"outlined\",onChange:onChangeInput}),/*#__PURE__*/_jsx(TextField,{name:\"moTa\",label:\"M\\xF4 t\\u1EA3\",multiline:true,rows:3,variant:\"outlined\",onChange:onChangeInput,value:dataMovie.moTa,defaultValue:\"Loading...\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-right\",children:[/*#__PURE__*/_jsx(LocalizationProvider,{dateAdapter:AdapterDateFns,children:/*#__PURE__*/_jsx(DatePicker,{label:\"Ng\\xE0y kh\\u1EDFi chi\\u1EBFu\",value:date,name:\"ngayKhoiChieu\",onChange:function onChange(newDate){return onSelectDate(newDate);},renderInput:function renderInput(params){return/*#__PURE__*/_jsx(TextField,_objectSpread({},params));}})}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:function onClick(){return onAdd();},children:\"T\\u1EA3i \\u1EA3nh l\\xEAn\"}),/*#__PURE__*/_jsx(\"input\",{name:\"hinhAnh\",type:\"file\",hidden:true,ref:inputAdd,onChange:onChangeInput}),/*#__PURE__*/_jsx(\"img\",{style:{width:'100%'},src:imgSrc,alt:\"thumbnail\"})]})]})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"error\",onClick:handleClose,children:\"H\\u1EE7y\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:onSubmit,type:\"submit\",children:\"C\\u1EADp nh\\u1EADt\"})]})]});};","map":{"version":3,"sources":["D:/FrontEnd/Project/newMovie/src/Pages/Admin/Movie/EditMovie.js"],"names":["AdapterDateFns","DatePicker","LocalizationProvider","Box","Button","Dialog","DialogActions","DialogContent","DialogTitle","TextField","isEmpty","moment","React","useEffect","useRef","useState","useDispatch","useSelector","getInfoMovie","updateMovie","EditMovie","open","handleClose","movieCode","movieInfo","state","MovieManagerReducer","dispatch","imgSrc","setImgSrc","date","setDate","tenPhim","trailer","ngayKhoiChieu","danhGia","moTa","hinhAnh","biDanh","maNhom","dataMovie","setDataMovie","inputAdd","onAdd","current","click","onSelectDate","newDate","newDataMovie","format","onChangeInput","event","target","name","value","newImgSrc","files","type","URL","createObjectURL","onSubmit","Object","keys","map","key","String","trim","form_data","FormData","append","newDataUpdate","fetchData","fontSize","display","justifyContent","alignItems","mb","width","backgroundColor","color","params"],"mappings":"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","sourcesContent":["/* eslint-disable react-hooks/rules-of-hooks */\r\nimport AdapterDateFns from '@mui/lab/AdapterDateFns';\r\nimport DatePicker from '@mui/lab/DatePicker';\r\nimport LocalizationProvider from '@mui/lab/LocalizationProvider';\r\nimport Box from '@mui/material/Box';\r\nimport Button from '@mui/material/Button';\r\nimport Dialog from '@mui/material/Dialog';\r\nimport DialogActions from '@mui/material/DialogActions';\r\nimport DialogContent from '@mui/material/DialogContent';\r\nimport DialogTitle from '@mui/material/DialogTitle';\r\nimport TextField from '@mui/material/TextField';\r\nimport { isEmpty } from 'lodash';\r\nimport moment from 'moment';\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { getInfoMovie, updateMovie } from '../../../Redux/Actions/MovieManagerActions';\r\n\r\n\r\nexport default function EditMovie({ open, handleClose, movieCode }) {\r\n    const movieInfo = useSelector(state => state.MovieManagerReducer.movieInfo)\r\n    const dispatch = useDispatch()\r\n    const [imgSrc, setImgSrc] = useState();\r\n    const [date, setDate] = React.useState(null);\r\n    const [dataMovie, setDataMovie] = useState({\r\n        tenPhim: '',\r\n        trailer: '',\r\n        ngayKhoiChieu: '',\r\n        danhGia: null,\r\n        moTa: '',\r\n        hinhAnh: {},\r\n        biDanh: '',\r\n        maNhom: 'GP01',\r\n    })\r\n    const inputAdd = useRef(null);\r\n    const onAdd = () => {\r\n        inputAdd.current.click();\r\n    };\r\n    const onSelectDate = (newDate) => {\r\n        let newDataMovie = { ...dataMovie, ngayKhoiChieu: moment(newDate).format('DD/MM/YYYY') }\r\n        setDate(newDate)\r\n        setDataMovie(newDataMovie)\r\n    }\r\n    const onChangeInput = (event) => {\r\n        let { name, value } = event.target\r\n        if (name !== 'hinhAnh') {\r\n            let newDataMovie = { ...dataMovie, [name]: value }\r\n            setDataMovie(newDataMovie)\r\n        } else {\r\n            let newImgSrc = event.target.files[0]\r\n            if (newImgSrc.type === 'image/png' || newImgSrc.type === 'image/jpg' || newImgSrc.type === 'image/gif' || newImgSrc.type === 'image/jpeg') {\r\n                let newDataMovie = { ...dataMovie, [name]: newImgSrc }\r\n                setDataMovie(newDataMovie)\r\n                setImgSrc(URL.createObjectURL(newImgSrc))\r\n            }\r\n        }\r\n    }\r\n    const onSubmit = () => {\r\n        // ------xoa khoang trang thua\r\n        Object.keys(dataMovie).map((key) => {\r\n            return dataMovie[key] = String(dataMovie[key]).trim()\r\n        });\r\n        // ---------------------------\r\n        let form_data = new FormData();\r\n        for (let key in dataMovie) {\r\n            form_data.append(key, dataMovie[key]);\r\n        }\r\n        dispatch(updateMovie(form_data))\r\n        handleClose()\r\n    }\r\n    useEffect(() => {\r\n        if (!isEmpty(movieInfo)) {\r\n            let newDataUpdate = {\r\n                tenPhim: movieInfo.tenPhim,\r\n                trailer: movieInfo.trailer,\r\n                ngayKhoiChieu: moment(movieInfo.ngayKhoiChieu).format('DD/MM/YYYY'),\r\n                danhGia: movieInfo.danhGia,\r\n                moTa: movieInfo.moTa,\r\n                hinhAnh: movieInfo.hinhAnh,\r\n                biDanh: movieInfo.biDanh,\r\n                maNhom: movieInfo.maNhom,\r\n            }\r\n            setImgSrc(movieInfo.hinhAnh)\r\n            setDate(moment(movieInfo.ngayKhoiChieu).format())\r\n            setDataMovie(newDataUpdate)\r\n        }\r\n    }, [movieInfo])\r\n    useEffect(() => {\r\n        if (movieCode) {\r\n            async function fetchData() {\r\n                dispatch(await getInfoMovie(movieCode))\r\n            }\r\n            fetchData();\r\n        }\r\n    }, [dispatch, movieCode])\r\n    return (\r\n        <Dialog\r\n            fullWidth\r\n            maxWidth='md'\r\n            open={open}\r\n            keepMounted\r\n            onClose={handleClose}\r\n            aria-describedby=\"alert-dialog-slide-description\"\r\n        >\r\n            <DialogTitle sx={{ fontSize: '30px' }}>{\"Sửa phim\"}</DialogTitle>\r\n            <DialogContent dividers>\r\n                <Box sx={{\r\n                    display: 'flex',\r\n                    justifyContent: 'space-between',\r\n                    alignItems: 'start',\r\n                    '& .MuiTextField-root': { mb: 2, width: '100%' },\r\n                    '& .MuiOutlinedInput-root, .MuiInputLabel-root': { fontSize: '15px' },\r\n                    '& .form-left': { width: '60%' },\r\n                    '& .form-right': { width: '37%' },\r\n                    '& .MuiButton-root': { display: 'block', mb: 2, fontSize: '15px', backgroundColor: '#d7d7d7', color: '#616161', width: '100%' },\r\n                }}>\r\n                    <div className='form-left'>\r\n                        <TextField name='tenPhim' label=\"Tên Phim\" variant=\"outlined\" onChange={onChangeInput} value={dataMovie.tenPhim} defaultValue='Loading...' />\r\n                        <TextField name='trailer' label=\"Trailer\" variant=\"outlined\" onChange={onChangeInput} value={dataMovie.trailer} defaultValue='Loading...' />\r\n                        <TextField name='biDanh' label=\"Bí Danh\" variant=\"outlined\" onChange={onChangeInput} value={dataMovie.biDanh} defaultValue='Loading...' />\r\n                        <TextField name='danhGia' label=\"Đánh giá\" variant=\"outlined\" type='number' onChange={onChangeInput} value={dataMovie.danhGia} defaultValue='0' />\r\n                        <TextField name='maNhom' label=\"Mã nhóm\" value='GP01' disabled variant=\"outlined\" onChange={onChangeInput} />\r\n                        <TextField name='moTa' label=\"Mô tả\" multiline rows={3} variant=\"outlined\" onChange={onChangeInput} value={dataMovie.moTa} defaultValue='Loading...' />\r\n                    </div>\r\n                    <div className='form-right'>\r\n                        <LocalizationProvider dateAdapter={AdapterDateFns}>\r\n                            <DatePicker\r\n                                label=\"Ngày khởi chiếu\"\r\n                                value={date}\r\n                                name='ngayKhoiChieu'\r\n                                onChange={(newDate) => onSelectDate(newDate)}\r\n                                renderInput={(params) => <TextField {...params} />}\r\n                            />\r\n                        </LocalizationProvider>\r\n                        <Button variant='contained' onClick={() => onAdd()} >\r\n                            Tải ảnh lên\r\n                        </Button>\r\n                        <input name='hinhAnh' type='file' hidden ref={inputAdd} onChange={onChangeInput} />\r\n                        <img style={{ width: '100%' }} src={imgSrc} alt='thumbnail' />\r\n                    </div>\r\n                </Box>\r\n            </DialogContent>\r\n            <DialogActions>\r\n                <Button variant='contained' color='error' onClick={handleClose} >Hủy</Button>\r\n                <Button variant='contained' color='primary' onClick={onSubmit} type='submit'>Cập nhật</Button>\r\n            </DialogActions>\r\n        </Dialog>\r\n\r\n    );\r\n};"]},"metadata":{},"sourceType":"module"}